# TODO List - 玄机阁AI算命应用

## 🚀 已完成
- ✅ RAG系统实现（1402条古籍知识库）
- ✅ Markdown渲染优化（使用marked.js）
- ✅ 移动端输入框固定和显示优化
- ✅ 发送按钮垂直居中修复
- ✅ 多语言支持（中英文切换）
- ✅ 支付系统集成（Stripe）
- ✅ 邮箱验证功能
- ✅ 聊天历史保存
- ✅ 用户配额管理
- ✅ 研究路由逻辑，目前Edge Function合并，不存在路由逻辑
- ✅ 用户信息数据库同步（跨设备同步姓名、生日、星座）
- ✅ 对话历史优化（内存限制100条，发送20条）
- ✅ async/await语法错误修复
- ✅ 星座识别改进（支持12星座）
- ✅ 性能优化（hasUpdate标记减少不必要写入）
- 收获：SHADCN和Taliwind UI库（收费）暂时用不上，目前已经是定制化


## 🎯 待优化事项

### 搁置：流氏输出的问题，不容易解决，因为markdown需要等输入完才能渲染，暂时搁置


### 0. 让CC检查代码是否正确

### 1. 发送按钮位置
**说明**: 目前发送按钮需要调整，改成类似chatgpt的形式
**状态**: 待修复

### 2. 英文用户体验优化
**问题**: 英文用户也会走RAG流程，但中文知识库匹配度低，浪费资源且效果不佳
**解决方案**:
- [ ] 方案A: 检测语言，英文用户跳过RAG直接用AI回答
- [ ] 方案B: 将英文问题翻译成中文再进行RAG检索
- [ ] 方案C: 建立英文知识库（长期方案）

**当前逻辑**:
```
所有用户 → 生成embedding → 搜索中文知识库 → similarity < 0.5 → 返回空 → AI通用回答
```




## 💡 其他优化建议

### 性能优化
- [ ] 考虑添加RAG缓存机制（常见问题缓存结果）
- [ ] 优化向量检索算法
- [ ] 添加CDN加速静态资源

### 功能增强
- [ ] 添加语音输入/输出功能
- [ ] 支持图片上传（手相分析等）
- [ ] 增加更多命理门类
- [ ] 添加每日签到/运势推送

### 用户体验
- [ ] 添加输入建议/快捷问题按钮
- [ ] 优化加载动画效果
- [ ] 添加消息分享功能
- [ ] 支持导出聊天记录

### 数据分析
- [ ] 添加用户行为统计
- [ ] 热门问题分析
- [ ] AI回答质量反馈机制

## 📝 技术债务
- [ ] 清理未使用的CSS样式
- [ ] 优化代码结构和注释
- [ ] 添加错误监控（如Sentry）
- [ ] 完善单元测试

## 🌐 国际化
- [ ] 完善英文版UI文案
- [ ] 考虑支持更多语言（日语、韩语等）
- [ ] 文化适配（西方占卜内容）

## 🔧 部署相关
- [ ] 添加自动化部署流程
- [ ] 配置环境变量管理
- [ ] 设置监控告警

---
*最后更新: 2025年11月4日*
